function o(t){switch(t){case 1:return"TW";case 2:return"ABW";case 3:return"MIT";case 4:return"ST";case 9999999999:default:return""}}const n=new Intl.NumberFormat("de",{maximumFractionDigits:0});KB_TOKEN&&(globalThis.KB_TOKEN=KB_TOKEN,globalThis.KB_PW=KB_PW,globalThis.KB_EMAIL=KB_EMAIL,globalThis.KB_LEAGUE_ID=KB_LEAGUE_ID);class a{constructor(){this.token=globalThis.KB_TOKEN,this.leagueId="2335868"}get default_opts(){return{headers:{cookie:`kkstrauth=${this.token}`,credentials:"include","x-bkb-cookie":this.token}}}async ensureLogin(){(this.token===""||!this.isJwtValid(this.token))&&(this.isJwtValid(globalThis.token)?this.token=globalThis.token:(console.log("JWT from env var is expired, gernerate a new one and write it into .env file!"),await this.login()))}async login(){const e=await(await fetch("https://api.kickbase.com/user/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:globalThis.KB_EMAIL,password:globalThis.KB_PW})})).json();this.leagueId=e.leagues[0].id;const{token:i}=e;return globalThis.token=i,this.token=i,this.token}isJwtValid(s){try{const e=JSON.parse(atob(s.split(".")[1]));return new Date(e.exp*1e3)>=new Date}catch{return!1}}}export{a as B,o as g,n as p};
